import{P as q,D as E}from"./assets/vendor-DVzGJjM7.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function s(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(t){if(t.ep)return;t.ep=!0;const c=s(t);fetch(t.href,c)}})();function L(){const e=document.getElementById("invoiceDate"),r=new Date,s=r.getFullYear(),l=String(r.getMonth()+1).padStart(2,"0"),t=String(r.getDate()).padStart(2,"0");e.value=`${s}-${l}-${t}`}function M(){const e=localStorage.getItem("lastInvoiceNumber");return e?Number(JSON.parse(e))+43:Math.floor(1e5+Math.random()*9e5)}function P(e){localStorage.setItem("lastInvoiceNumber",JSON.stringify(e))}function b(){const e=localStorage.getItem("products");return e?JSON.parse(e):[]}function $(e){localStorage.setItem("products",JSON.stringify(e))}function w(){const e=document.getElementById("products");e.innerHTML="",b().forEach(r=>{const s=document.createElement("option");s.value=r,e.appendChild(s)})}function x(){const e=document.getElementById("items"),r=document.createElement("div");r.classList.add("item-row"),r.innerHTML=`
    <input name="productName" list="products" placeholder="Назва товару" required>
    <input name="qty" type="number" step="1" placeholder="Кількість" required>
    <input name="measurementUnit" placeholder="Одиниця вимірювання" required/>
    <input name="price" type="number" step="0.01" placeholder="Ціна" required>
  `,e.appendChild(r)}let h=null;async function B(){try{h=await window.showDirectoryPicker(),localStorage.setItem("saveDirName",h.name),window.directoryHandle=h,document.getElementById("chosenPathLabel").textContent=`✓ ${h.name}`}catch(e){console.warn("Вибір директорії скасовано",e)}}function O(e){const r=["","одна","дві","три","чотири","п’ять","шість","сім","вісім","дев’ять"],s=["","один","два","три","чотири","п’ять","шість","сім","вісім","дев’ять"],l=["десять","одинадцять","дванадцять","тринадцять","чотирнадцять","п’ятнадцять","шістнадцять","сімнадцять","вісімнадцять","дев’ятнадцять"],t=["","","двадцять","тридцять","сорок","п’ятдесят","шістдесят","сімдесят","вісімдесят","дев’яносто"],c=["","сто","двісті","триста","чотириста","п’ятсот","шістсот","сімсот","вісімсот","дев’ятсот"];function u(o,n){const i=o%10,a=o%100;return a>=11&&a<=19?n[2]:i===1?n[0]:i>=2&&i<=4?n[1]:n[2]}function m(o,n="masculine"){if(o===0)return"нуль";let i="";if(o>=100){const a=Math.floor(o/100);i+=c[a]+" ",o%=100}if(o>=20){const a=Math.floor(o/10);i+=t[a]+" ",o%=10}return o>=10&&(i+=l[o-10]+" ",o=0),o>0&&(i+=(n==="feminine"?r:s)[o]+" "),i.trim()}function p(o){if(o===0)return"нуль";const n=Math.floor(o/1e6),i=Math.floor(o%1e6/1e3),a=o%1e3;let d="";return n>0&&(d+=m(n)+" "+u(n,["мільйон","мільйони","мільйонів"])+" "),i>0&&(d+=m(i,"feminine")+" "+u(i,["тисяча","тисячі","тисяч"])+" "),a>0&&(d+=m(a,"feminine")+" "),d.trim()}const f=Math.floor(e),y=Math.round((e-f)*100),g=p(f),S=u(f,["гривня","гривні","гривень"]),v=m(y,"feminine"),D=u(y,["копійка","копійки","копійок"]);return`${g[0].toUpperCase()+g.slice(1)} ${S} ${v} ${D}`}async function T(e){const r=e.fileName.value.trim(),s=e.supplier.value.trim(),l=e.buyer.value.trim(),t=e.invoiceNumber.value.trim(),c=new Date(e.invoiceDate.value),u=e.invoiceDate.value,m=c.toLocaleDateString("uk-UA",{day:"numeric",month:"long",year:"numeric"}),p=Array.from(document.querySelectorAll("#items .item-row")).map((n,i)=>{const a=n.querySelector('input[name="productName"]').value.trim(),d=parseFloat(n.querySelector('input[name="qty"]').value),N=parseFloat(n.querySelector('input[name="price"]').value),I=n.querySelector('input[name="measurementUnit"]').value.trim(),F=+(d*N).toFixed(2);return{no:i+1,productName:a,qty:d,measurementUnit:I,price:N.toFixed(2),sum:F.toFixed(2)}}),f=p.reduce((n,i)=>n+parseFloat(i.sum),0).toFixed(2),y=new Set([...b(),...p.map(n=>n.productName)]);$([...y]),w(),P(t);const g=await fetch("/template.docx").then(n=>n.arrayBuffer()),S=new q(g),v=new E(S,{paragraphLoop:!0,linebreaks:!0});v.render({supplier:s,buyer:l,invoiceNumber:t,invoiceDate:m,items:p,length:p.length,total:f,totalWithWords:O(f)});const D=v.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),o=`${r}_${u}_${t}.docx`;await saveToDirectory(D,o)}L();w();document.querySelector('input[name="invoiceNumber"]').value=M();document.getElementById("addRowBtn").addEventListener("click",x);document.getElementById("chooseDirBtn").addEventListener("click",B);document.getElementById("invoiceForm").addEventListener("submit",async e=>{e.preventDefault(),await T(e.target)});
//# sourceMappingURL=index.js.map
