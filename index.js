import{F as q,P as x,D as L}from"./assets/vendor-uWM_4msG.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&u(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function u(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}})();function $(){const e=document.getElementById("invoiceDate"),t=new Date,i=t.getFullYear(),u=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");e.value=`${i}-${u}-${n}`}function M(){const e=localStorage.getItem("lastInvoiceNumber");return e?Number(JSON.parse(e))+43:Math.floor(1e5+Math.random()*9e5)}function P(e){localStorage.setItem("lastInvoiceNumber",JSON.stringify(e))}function F(){const e=localStorage.getItem("products");return e?JSON.parse(e):[]}function B(e){localStorage.setItem("products",JSON.stringify(e))}function N(){const e=document.getElementById("products");e.innerHTML="",F().forEach(t=>{const i=document.createElement("option");i.value=t,e.appendChild(i)})}function O(){const e=document.getElementById("items"),t=document.createElement("div");t.classList.add("item-row"),t.innerHTML=`
    <input name="productName" list="products" placeholder="ÐÐ°Ð·Ð²Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ñƒ" required>
    <input name="qty" type="number" step="1" placeholder="ÐšÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ" required>
    <input name="measurementUnit" placeholder="ÐžÐ´Ð¸Ð½Ð¸Ñ†Ñ Ð²Ð¸Ð¼Ñ–Ñ€ÑŽÐ²Ð°Ð½Ð½Ñ" required/>
    <input name="price" type="number" step="0.01" placeholder="Ð¦Ñ–Ð½Ð°" required>
  `,e.appendChild(t)}let m=null;async function T(){try{m=await window.showDirectoryPicker(),localStorage.setItem("saveDirName",m.name),window.directoryHandle=m,document.getElementById("chosenPathLabel").textContent=`âœ“ ${m.name}`}catch(e){console.warn("Ð’Ð¸Ð±Ñ–Ñ€ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ñ–Ñ— ÑÐºÐ°ÑÐ¾Ð²Ð°Ð½Ð¾",e)}}async function W(e,t){try{if(!m){q.saveAs(e,t),D(`Ð¤Ð°Ð¹Ð» "${t}" Ð·Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¾ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾.`);return}const u=await(await m.getFileHandle(t,{create:!0})).createWritable();await u.write(e),await u.close(),D(`Ð¤Ð°Ð¹Ð» "${t}" ÑƒÑÐ¿Ñ–ÑˆÐ½Ð¾ Ð·Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¾ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ñ–Ñ— "${m.name}".`)}catch(i){console.error("ÐŸÐ¾Ð¼Ð¸Ð»ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð½Ñ–:",i),D("âŒ ÐŸÐ¾Ð¼Ð¸Ð»ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð½Ñ– Ñ„Ð°Ð¹Ð»Ñƒ.",!0)}}function D(e,t=!1){const i=document.getElementById("saveStatus");i.textContent=e,i.style.color=t?"red":"green",setTimeout(()=>{i.textContent=""},5e3)}function _(e){const t=["","Ð¾Ð´Ð½Ð°","Ð´Ð²Ñ–","Ñ‚Ñ€Ð¸","Ñ‡Ð¾Ñ‚Ð¸Ñ€Ð¸","Ð¿â€™ÑÑ‚ÑŒ","ÑˆÑ–ÑÑ‚ÑŒ","ÑÑ–Ð¼","Ð²Ñ–ÑÑ–Ð¼","Ð´ÐµÐ²â€™ÑÑ‚ÑŒ"],i=["","Ð¾Ð´Ð¸Ð½","Ð´Ð²Ð°","Ñ‚Ñ€Ð¸","Ñ‡Ð¾Ñ‚Ð¸Ñ€Ð¸","Ð¿â€™ÑÑ‚ÑŒ","ÑˆÑ–ÑÑ‚ÑŒ","ÑÑ–Ð¼","Ð²Ñ–ÑÑ–Ð¼","Ð´ÐµÐ²â€™ÑÑ‚ÑŒ"],u=["Ð´ÐµÑÑÑ‚ÑŒ","Ð¾Ð´Ð¸Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ð´Ð²Ð°Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ñ‚Ñ€Ð¸Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ñ‡Ð¾Ñ‚Ð¸Ñ€Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ð¿â€™ÑÑ‚Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","ÑˆÑ–ÑÑ‚Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","ÑÑ–Ð¼Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ð²Ñ–ÑÑ–Ð¼Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ð´ÐµÐ²â€™ÑÑ‚Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ"],n=["","","Ð´Ð²Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ñ‚Ñ€Ð¸Ð´Ñ†ÑÑ‚ÑŒ","ÑÐ¾Ñ€Ð¾Ðº","Ð¿â€™ÑÑ‚Ð´ÐµÑÑÑ‚","ÑˆÑ–ÑÑ‚Ð´ÐµÑÑÑ‚","ÑÑ–Ð¼Ð´ÐµÑÑÑ‚","Ð²Ñ–ÑÑ–Ð¼Ð´ÐµÑÑÑ‚","Ð´ÐµÐ²â€™ÑÐ½Ð¾ÑÑ‚Ð¾"],a=["","ÑÑ‚Ð¾","Ð´Ð²Ñ–ÑÑ‚Ñ–","Ñ‚Ñ€Ð¸ÑÑ‚Ð°","Ñ‡Ð¾Ñ‚Ð¸Ñ€Ð¸ÑÑ‚Ð°","Ð¿â€™ÑÑ‚ÑÐ¾Ñ‚","ÑˆÑ–ÑÑ‚ÑÐ¾Ñ‚","ÑÑ–Ð¼ÑÐ¾Ñ‚","Ð²Ñ–ÑÑ–Ð¼ÑÐ¾Ñ‚","Ð´ÐµÐ²â€™ÑÑ‚ÑÐ¾Ñ‚"];function l(o,r){const c=o%10,s=o%100;return s>=11&&s<=19?r[2]:c===1?r[0]:c>=2&&c<=4?r[1]:r[2]}function p(o,r="masculine"){if(o===0)return"Ð½ÑƒÐ»ÑŒ";let c="";if(o>=100){const s=Math.floor(o/100);c+=a[s]+" ",o%=100}if(o>=20){const s=Math.floor(o/10);c+=n[s]+" ",o%=10}return o>=10&&(c+=u[o-10]+" ",o=0),o>0&&(c+=(r==="feminine"?t:i)[o]+" "),c.trim()}function f(o){if(o===0)return"Ð½ÑƒÐ»ÑŒ";const r=Math.floor(o/1e6),c=Math.floor(o%1e6/1e3),s=o%1e3;let d="";return r>0&&(d+=p(r)+" "+l(r,["Ð¼Ñ–Ð»ÑŒÐ¹Ð¾Ð½","Ð¼Ñ–Ð»ÑŒÐ¹Ð¾Ð½Ð¸","Ð¼Ñ–Ð»ÑŒÐ¹Ð¾Ð½Ñ–Ð²"])+" "),c>0&&(d+=p(c,"feminine")+" "+l(c,["Ñ‚Ð¸ÑÑÑ‡Ð°","Ñ‚Ð¸ÑÑÑ‡Ñ–","Ñ‚Ð¸ÑÑÑ‡"])+" "),s>0&&(d+=p(s,"feminine")+" "),d.trim()}const y=Math.floor(e),v=Math.round((e-y)*100),g=f(y),S=l(y,["Ð³Ñ€Ð¸Ð²Ð½Ñ","Ð³Ñ€Ð¸Ð²Ð½Ñ–","Ð³Ñ€Ð¸Ð²ÐµÐ½ÑŒ"]),h=p(v,"feminine"),w=l(v,["ÐºÐ¾Ð¿Ñ–Ð¹ÐºÐ°","ÐºÐ¾Ð¿Ñ–Ð¹ÐºÐ¸","ÐºÐ¾Ð¿Ñ–Ð¹Ð¾Ðº"]);return`${g[0].toUpperCase()+g.slice(1)} ${S} ${h} ${w}`}const C="/invoice-creator/template.docx";async function H(e){const t=e.fileName.value.trim(),i=e.supplier.value.trim(),u=e.buyer.value.trim(),n=e.invoiceNumber.value.trim(),a=new Date(e.invoiceDate.value),l=e.invoiceDate.value,p=a.toLocaleDateString("uk-UA",{day:"numeric",month:"long",year:"numeric"}),f=Array.from(document.querySelectorAll("#items .item-row")).map((r,c)=>{const s=r.querySelector('input[name="productName"]').value.trim(),d=parseFloat(r.querySelector('input[name="qty"]').value),b=parseFloat(r.querySelector('input[name="price"]').value),I=r.querySelector('input[name="measurementUnit"]').value.trim(),E=+(d*b).toFixed(2);return{no:c+1,productName:s,qty:d,measurementUnit:I,price:b.toFixed(2),sum:E.toFixed(2)}}),y=f.reduce((r,c)=>r+parseFloat(c.sum),0).toFixed(2),v=new Set([...F(),...f.map(r=>r.productName)]);B([...v]),N(),P(n);const g=await fetch(C).then(r=>r.arrayBuffer());console.log("ðŸš€ ~ generateDocx ~ templateContent:",g);const S=new x(g),h=new L(S,{paragraphLoop:!0,linebreaks:!0});h.render({supplier:i,buyer:u,invoiceNumber:n,invoiceDate:p,items:f,length:f.length,total:y,totalWithWords:_(y)});const w=h.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),o=`${t}_${l}_${n}.docx`;await W(w,o)}$();N();document.querySelector('input[name="invoiceNumber"]').value=M();document.getElementById("addRowBtn").addEventListener("click",O);document.getElementById("chooseDirBtn").addEventListener("click",T);document.getElementById("invoiceForm").addEventListener("submit",async e=>{e.preventDefault(),await H(e.target)});
//# sourceMappingURL=index.js.map
