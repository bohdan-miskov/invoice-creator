import{F as q,P as x,D as L}from"./assets/vendor-uWM_4msG.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&u(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function u(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}})();function $(){const e=document.getElementById("invoiceDate"),t=new Date,i=t.getFullYear(),u=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");e.value=`${i}-${u}-${n}`}function M(){const e=localStorage.getItem("lastInvoiceNumber");return e?Number(JSON.parse(e))+43:Math.floor(1e5+Math.random()*9e5)}function P(e){localStorage.setItem("lastInvoiceNumber",JSON.stringify(e))}function F(){const e=localStorage.getItem("products");return e?JSON.parse(e):[]}function B(e){localStorage.setItem("products",JSON.stringify(e))}function N(){const e=document.getElementById("products");e.innerHTML="",F().forEach(t=>{const i=document.createElement("option");i.value=t,e.appendChild(i)})}function O(){const e=document.getElementById("items"),t=document.createElement("div");t.classList.add("item-row"),t.innerHTML=`
    <input name="productName" list="products" placeholder="Назва товару" required>
    <input name="qty" type="number" step="1" placeholder="Кількість" required>
    <input name="measurementUnit" placeholder="Одиниця вимірювання" required/>
    <input name="price" type="number" step="0.01" placeholder="Ціна" required>
  `,e.appendChild(t)}let m=null;async function T(){try{m=await window.showDirectoryPicker(),localStorage.setItem("saveDirName",m.name),window.directoryHandle=m,document.getElementById("chosenPathLabel").textContent=`✓ ${m.name}`}catch(e){console.warn("Вибір директорії скасовано",e)}}async function W(e,t){try{if(!m){q.saveAs(e,t),D(`Файл "${t}" збережено локально.`);return}const u=await(await m.getFileHandle(t,{create:!0})).createWritable();await u.write(e),await u.close(),D(`Файл "${t}" успішно збережено в директорії "${m.name}".`)}catch(i){console.error("Помилка при збереженні:",i),D("❌ Помилка при збереженні файлу.",!0)}}function D(e,t=!1){const i=document.getElementById("saveStatus");i.textContent=e,i.style.color=t?"red":"green",setTimeout(()=>{i.textContent=""},5e3)}function _(e){const t=["","одна","дві","три","чотири","п’ять","шість","сім","вісім","дев’ять"],i=["","один","два","три","чотири","п’ять","шість","сім","вісім","дев’ять"],u=["десять","одинадцять","дванадцять","тринадцять","чотирнадцять","п’ятнадцять","шістнадцять","сімнадцять","вісімнадцять","дев’ятнадцять"],n=["","","двадцять","тридцять","сорок","п’ятдесят","шістдесят","сімдесят","вісімдесят","дев’яносто"],a=["","сто","двісті","триста","чотириста","п’ятсот","шістсот","сімсот","вісімсот","дев’ятсот"];function l(o,r){const c=o%10,s=o%100;return s>=11&&s<=19?r[2]:c===1?r[0]:c>=2&&c<=4?r[1]:r[2]}function p(o,r="masculine"){if(o===0)return"нуль";let c="";if(o>=100){const s=Math.floor(o/100);c+=a[s]+" ",o%=100}if(o>=20){const s=Math.floor(o/10);c+=n[s]+" ",o%=10}return o>=10&&(c+=u[o-10]+" ",o=0),o>0&&(c+=(r==="feminine"?t:i)[o]+" "),c.trim()}function f(o){if(o===0)return"нуль";const r=Math.floor(o/1e6),c=Math.floor(o%1e6/1e3),s=o%1e3;let d="";return r>0&&(d+=p(r)+" "+l(r,["мільйон","мільйони","мільйонів"])+" "),c>0&&(d+=p(c,"feminine")+" "+l(c,["тисяча","тисячі","тисяч"])+" "),s>0&&(d+=p(s,"feminine")+" "),d.trim()}const y=Math.floor(e),v=Math.round((e-y)*100),g=f(y),S=l(y,["гривня","гривні","гривень"]),h=p(v,"feminine"),w=l(v,["копійка","копійки","копійок"]);return`${g[0].toUpperCase()+g.slice(1)} ${S} ${h} ${w}`}const C="/invoice-creator/template.docx";async function H(e){const t=e.fileName.value.trim(),i=e.supplier.value.trim(),u=e.buyer.value.trim(),n=e.invoiceNumber.value.trim(),a=new Date(e.invoiceDate.value),l=e.invoiceDate.value,p=a.toLocaleDateString("uk-UA",{day:"numeric",month:"long",year:"numeric"}),f=Array.from(document.querySelectorAll("#items .item-row")).map((r,c)=>{const s=r.querySelector('input[name="productName"]').value.trim(),d=parseFloat(r.querySelector('input[name="qty"]').value),b=parseFloat(r.querySelector('input[name="price"]').value),I=r.querySelector('input[name="measurementUnit"]').value.trim(),E=+(d*b).toFixed(2);return{no:c+1,productName:s,qty:d,measurementUnit:I,price:b.toFixed(2),sum:E.toFixed(2)}}),y=f.reduce((r,c)=>r+parseFloat(c.sum),0).toFixed(2),v=new Set([...F(),...f.map(r=>r.productName)]);B([...v]),N(),P(n);const g=await fetch(C).then(r=>r.arrayBuffer());console.log("🚀 ~ generateDocx ~ templateContent:",g);const S=new x(g),h=new L(S,{paragraphLoop:!0,linebreaks:!0});h.render({supplier:i,buyer:u,invoiceNumber:n,invoiceDate:p,items:f,length:f.length,total:y,totalWithWords:_(y)});const w=h.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),o=`${t}_${l}_${n}.docx`;await W(w,o)}$();N();document.querySelector('input[name="invoiceNumber"]').value=M();document.getElementById("addRowBtn").addEventListener("click",O);document.getElementById("chooseDirBtn").addEventListener("click",T);document.getElementById("invoiceForm").addEventListener("submit",async e=>{e.preventDefault(),await H(e.target)});
//# sourceMappingURL=index.js.map
