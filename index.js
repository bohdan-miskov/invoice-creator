import{F as x,P as q,D as L}from"./assets/vendor-uWM_4msG.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&u(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function u(n){if(n.ep)return;n.ep=!0;const c=i(n);fetch(n.href,c)}})();function $(){const e=document.getElementById("invoiceDate"),t=new Date,i=t.getFullYear(),u=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");e.value=`${i}-${u}-${n}`}function M(){const e=localStorage.getItem("lastInvoiceNumber");return e?Number(JSON.parse(e))+43:Math.floor(1e5+Math.random()*9e5)}function P(e){localStorage.setItem("lastInvoiceNumber",JSON.stringify(e))}function F(){const e=localStorage.getItem("products");return e?JSON.parse(e):[]}function B(e){localStorage.setItem("products",JSON.stringify(e))}function N(){const e=document.getElementById("products");e.innerHTML="",F().forEach(t=>{const i=document.createElement("option");i.value=t,e.appendChild(i)})}function C(){const e=document.getElementById("items"),t=document.createElement("div");t.classList.add("item-row"),t.innerHTML=`
    <input name="productName" list="products" placeholder="ÐÐ°Ð·Ð²Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ñƒ" required>
    <input name="qty" type="number" step="1" placeholder="ÐšÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ" required>
    <input name="measurementUnit" placeholder="ÐžÐ´Ð¸Ð½Ð¸Ñ†Ñ Ð²Ð¸Ð¼Ñ–Ñ€ÑŽÐ²Ð°Ð½Ð½Ñ" required/>
    <input name="price" type="number" step="0.01" placeholder="Ð¦Ñ–Ð½Ð°" required>
  `,e.appendChild(t)}let m=null;async function O(){try{m=await window.showDirectoryPicker(),localStorage.setItem("saveDirName",m.name),window.directoryHandle=m,document.getElementById("chosenPathLabel").textContent=`âœ“ ${m.name}`}catch(e){console.warn("Ð’Ð¸Ð±Ñ–Ñ€ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ñ–Ñ— ÑÐºÐ°ÑÐ¾Ð²Ð°Ð½Ð¾",e)}}async function T(e,t){try{if(!m){x.saveAs(e,t),D(`Ð¤Ð°Ð¹Ð» "${t}" Ð·Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¾ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾.`);return}const u=await(await m.getFileHandle(t,{create:!0})).createWritable();await u.write(e),await u.close(),D(`Ð¤Ð°Ð¹Ð» "${t}" ÑƒÑÐ¿Ñ–ÑˆÐ½Ð¾ Ð·Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¾ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ñ–Ñ— "${m.name}".`)}catch(i){console.error("ÐŸÐ¾Ð¼Ð¸Ð»ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð½Ñ–:",i),D("âŒ ÐŸÐ¾Ð¼Ð¸Ð»ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð½Ñ– Ñ„Ð°Ð¹Ð»Ñƒ.",!0)}}function D(e,t=!1){const i=document.getElementById("saveStatus");i.textContent=e,i.style.color=t?"red":"green",setTimeout(()=>{i.textContent=""},5e3)}function W(e){const t=["","Ð¾Ð´Ð½Ð°","Ð´Ð²Ñ–","Ñ‚Ñ€Ð¸","Ñ‡Ð¾Ñ‚Ð¸Ñ€Ð¸","Ð¿â€™ÑÑ‚ÑŒ","ÑˆÑ–ÑÑ‚ÑŒ","ÑÑ–Ð¼","Ð²Ñ–ÑÑ–Ð¼","Ð´ÐµÐ²â€™ÑÑ‚ÑŒ"],i=["","Ð¾Ð´Ð¸Ð½","Ð´Ð²Ð°","Ñ‚Ñ€Ð¸","Ñ‡Ð¾Ñ‚Ð¸Ñ€Ð¸","Ð¿â€™ÑÑ‚ÑŒ","ÑˆÑ–ÑÑ‚ÑŒ","ÑÑ–Ð¼","Ð²Ñ–ÑÑ–Ð¼","Ð´ÐµÐ²â€™ÑÑ‚ÑŒ"],u=["Ð´ÐµÑÑÑ‚ÑŒ","Ð¾Ð´Ð¸Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ð´Ð²Ð°Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ñ‚Ñ€Ð¸Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ñ‡Ð¾Ñ‚Ð¸Ñ€Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ð¿â€™ÑÑ‚Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","ÑˆÑ–ÑÑ‚Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","ÑÑ–Ð¼Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ð²Ñ–ÑÑ–Ð¼Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ð´ÐµÐ²â€™ÑÑ‚Ð½Ð°Ð´Ñ†ÑÑ‚ÑŒ"],n=["","","Ð´Ð²Ð°Ð´Ñ†ÑÑ‚ÑŒ","Ñ‚Ñ€Ð¸Ð´Ñ†ÑÑ‚ÑŒ","ÑÐ¾Ñ€Ð¾Ðº","Ð¿â€™ÑÑ‚Ð´ÐµÑÑÑ‚","ÑˆÑ–ÑÑ‚Ð´ÐµÑÑÑ‚","ÑÑ–Ð¼Ð´ÐµÑÑÑ‚","Ð²Ñ–ÑÑ–Ð¼Ð´ÐµÑÑÑ‚","Ð´ÐµÐ²â€™ÑÐ½Ð¾ÑÑ‚Ð¾"],c=["","ÑÑ‚Ð¾","Ð´Ð²Ñ–ÑÑ‚Ñ–","Ñ‚Ñ€Ð¸ÑÑ‚Ð°","Ñ‡Ð¾Ñ‚Ð¸Ñ€Ð¸ÑÑ‚Ð°","Ð¿â€™ÑÑ‚ÑÐ¾Ñ‚","ÑˆÑ–ÑÑ‚ÑÐ¾Ñ‚","ÑÑ–Ð¼ÑÐ¾Ñ‚","Ð²Ñ–ÑÑ–Ð¼ÑÐ¾Ñ‚","Ð´ÐµÐ²â€™ÑÑ‚ÑÐ¾Ñ‚"];function l(o,r){const a=o%10,s=o%100;return s>=11&&s<=19?r[2]:a===1?r[0]:a>=2&&a<=4?r[1]:r[2]}function p(o,r="masculine"){if(o===0)return"Ð½ÑƒÐ»ÑŒ";let a="";if(o>=100){const s=Math.floor(o/100);a+=c[s]+" ",o%=100}if(o>=20){const s=Math.floor(o/10);a+=n[s]+" ",o%=10}return o>=10&&(a+=u[o-10]+" ",o=0),o>0&&(a+=(r==="feminine"?t:i)[o]+" "),a.trim()}function f(o){if(o===0)return"Ð½ÑƒÐ»ÑŒ";const r=Math.floor(o/1e6),a=Math.floor(o%1e6/1e3),s=o%1e3;let d="";return r>0&&(d+=p(r)+" "+l(r,["Ð¼Ñ–Ð»ÑŒÐ¹Ð¾Ð½","Ð¼Ñ–Ð»ÑŒÐ¹Ð¾Ð½Ð¸","Ð¼Ñ–Ð»ÑŒÐ¹Ð¾Ð½Ñ–Ð²"])+" "),a>0&&(d+=p(a,"feminine")+" "+l(a,["Ñ‚Ð¸ÑÑÑ‡Ð°","Ñ‚Ð¸ÑÑÑ‡Ñ–","Ñ‚Ð¸ÑÑÑ‡"])+" "),s>0&&(d+=p(s,"feminine")+" "),d.trim()}const y=Math.floor(e),v=Math.round((e-y)*100),g=f(y),w=l(y,["Ð³Ñ€Ð¸Ð²Ð½Ñ","Ð³Ñ€Ð¸Ð²Ð½Ñ–","Ð³Ñ€Ð¸Ð²ÐµÐ½ÑŒ"]),h=p(v,"feminine"),S=l(v,["ÐºÐ¾Ð¿Ñ–Ð¹ÐºÐ°","ÐºÐ¾Ð¿Ñ–Ð¹ÐºÐ¸","ÐºÐ¾Ð¿Ñ–Ð¹Ð¾Ðº"]);return`${g[0].toUpperCase()+g.slice(1)} ${w} ${h} ${S}`}async function _(e){const t=e.fileName.value.trim(),i=e.supplier.value.trim(),u=e.buyer.value.trim(),n=e.invoiceNumber.value.trim(),c=new Date(e.invoiceDate.value),l=e.invoiceDate.value,p=c.toLocaleDateString("uk-UA",{day:"numeric",month:"long",year:"numeric"}),f=Array.from(document.querySelectorAll("#items .item-row")).map((r,a)=>{const s=r.querySelector('input[name="productName"]').value.trim(),d=parseFloat(r.querySelector('input[name="qty"]').value),b=parseFloat(r.querySelector('input[name="price"]').value),I=r.querySelector('input[name="measurementUnit"]').value.trim(),E=+(d*b).toFixed(2);return{no:a+1,productName:s,qty:d,measurementUnit:I,price:b.toFixed(2),sum:E.toFixed(2)}}),y=f.reduce((r,a)=>r+parseFloat(a.sum),0).toFixed(2),v=new Set([...F(),...f.map(r=>r.productName)]);B([...v]),N(),P(n);const g=await fetch("/template.docx").then(r=>r.arrayBuffer());console.log("ðŸš€ ~ generateDocx ~ templateContent:",g);const w=new q(g),h=new L(w,{paragraphLoop:!0,linebreaks:!0});h.render({supplier:i,buyer:u,invoiceNumber:n,invoiceDate:p,items:f,length:f.length,total:y,totalWithWords:W(y)});const S=h.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),o=`${t}_${l}_${n}.docx`;await T(S,o)}const H=await fetch("/template.docx").then(e=>e.arrayBuffer());console.log("ðŸš€ ~ templateContent:",H);$();N();document.querySelector('input[name="invoiceNumber"]').value=M();document.getElementById("addRowBtn").addEventListener("click",C);document.getElementById("chooseDirBtn").addEventListener("click",O);document.getElementById("invoiceForm").addEventListener("submit",async e=>{e.preventDefault(),await _(e.target)});
//# sourceMappingURL=index.js.map
